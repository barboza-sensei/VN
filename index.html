<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sueño Algebraico</title>
  
  <link rel="stylesheet" href="style.css"> 
  
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <style>
    /* ------------------------------------------------------------------ */
    /* ESTILOS LOCALES (Sobrescriben o complementan a style.css)          */
    /* ------------------------------------------------------------------ */
    body {
      background: url('assets/bg/intro_noche.png') center/cover no-repeat;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      text-align: center;
      background-color: black;
      overflow-x: hidden;
      overflow-y: auto;
      
      /* La fuente base (Georgia, Times New Roman) se aplica en style.css al body */
      
      padding: 1em 0;
      position: relative; /* Necesario para los botones fijos */
    }

    h1 {
      font-family: 'Cinzel Decorative', serif;
      color: #f1f1f1;
      font-size: 3em;
      text-shadow: 0 0 10px #66ccff;
      animation: pulse 3s infinite;
      font-size: clamp(2em, 8vw, 3em); 
      margin-top: 1em;
      transition: opacity 0.5s; /* Para la transición al iniciar */
    }

    @keyframes pulse {
      0%, 100% { text-shadow: 0 0 10px #66ccff; }
      50% { text-shadow: 0 0 25px #aaffff; }
    }

    #menu {
      display: flex;
      flex-direction: column;
      gap: 1em;
      margin-top: 2em;
      width: 90%; 
      max-width: 300px; 
      transition: opacity 0.5s; /* Para la transición al iniciar */
    }

    .menu-btn {
      font-size: 1.2em;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid #aaa;
      color: #fff;
      padding: 0.8em 1.5em;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%; 
      box-sizing: border-box; 
    }

    .menu-btn:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: scale(1.05);
    }
    
    @media (min-width: 768px) {
        .menu-btn {
            font-size: 1.4em;
        }
    }

    footer {
      margin-top: auto; 
      padding-top: 3em; 
      padding-bottom: 1em;
      color: rgba(255, 255, 255, 0.6);
      font-size: 0.8em;
      width: 100%; 
      text-align: center;
      transition: opacity 0.5s; /* Para la transición al iniciar */
    }

    /* NOTA: Los estilos de muteButton, dyslexiaButton, transition-video y black-overlay 
        se recomienda que estén en style.css para ser globales.
    */
  </style>
</head>
<body>
  
  <audio id="backgroundMusic" src="assets/sfx/ambient-loop.wav" autoplay loop></audio>

  <h1 id="intro-title">Sueño Algebraico</h1>

  <div id="menu">
    <button id="startGameBtn" class="menu-btn">Iniciar</button>
    <button class="menu-btn" onclick="window.location.href='credits.html'">Créditos</button>
  </div>

  <footer id="intro-footer">Un proyecto didáctico gamificado</footer>
  
  <button id="muteButton" title="Silenciar/Activar Música">
      <i class="fas fa-volume-up"></i>
  </button>
  <button id="dyslexia-mode-button" title="Activar/Desactivar Modo Dislexia">A</button>


  <video id="transition-video" muted playsinline preload="auto">
      <source src="assets/video/vortex_transition.mp4" type="video/mp4"> 
  </video>
  <div id="black-overlay"></div> 
  

  <script src="global.js"></script> 
  
  <script>
    document.getElementById('startGameBtn').addEventListener('click', startTransition);
    
    // Función de Transición Cinematográfica
    function startTransition() {
        const startButton = document.getElementById('startGameBtn');
        const menuContainer = document.getElementById('menu');
        const introTitle = document.getElementById('intro-title');
        const introFooter = document.getElementById('intro-footer');
        const video = document.getElementById('transition-video');
        const blackOverlay = document.getElementById('black-overlay');
        
        // Desactivar el botón y ocultar la UI con una transición suave
        startButton.disabled = true;
        menuContainer.style.opacity = 0;
        introTitle.style.opacity = 0;
        introFooter.style.opacity = 0;
        
        // 1. Mostrar el video (opacidad 1) e iniciar
        video.style.opacity = 1;
        video.currentTime = 0;
        video.play().catch(error => {
            console.error("Error al reproducir el video:", error);
            // Fallback si el navegador no permite reproducir
            blackOverlay.style.opacity = 1; 
            setTimeout(navigateToNextScene, 1000);
        });

        // 2. Orquestación del Fundido a Negro y Navegación
        const fadeStartTime = 4000; // Iniciar fundido a los 4 segundos
        const navigationTime = 5000; // Navegar cuando el fundido sea total (5 segundos)
        
        // Iniciar el Fundido a Negro
        setTimeout(() => {
            if (blackOverlay) {
                blackOverlay.style.opacity = 1; 
            }
            // Pausar el video para enmascarar su final abrupto
            video.pause(); 
        }, fadeStartTime);

        // Navegar a la siguiente escena
        setTimeout(navigateToNextScene, navigationTime);
    }

    function navigateToNextScene() {
        // Redirigir a la primera escena del juego (Asegúrate de que esta ruta sea correcta)
        window.location.href = 'scene/scene0/index.html'; 
    }
  </script>
</body>
</html>
